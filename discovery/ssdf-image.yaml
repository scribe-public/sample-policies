name: "SSDF_IMAGE"
defaults:
  evidence:
    signed: true

rules:
  - uses: sbom/artifact-signed@v1
    description: "[SSDF-PS-2] Provide a mechanism to verify the integrity of the image"
    level: warning

  - uses: experimental/demodata/data@v1
    description: |
      "[SSDF-PS-3.1] Verify that the software release data is archived"
      "We assume running in Github thus the code is allways stored in a repository"
    with: 
      allow: true
      short_description: Code is archived.
      description: Since the code is within a repository, it is archived.
      reason: This is a demo rule, planned to run from a workflow in a repository.

  - uses: sbom/artifact-signed@v1
    description: "[SSDF-PS-3.2] Archive SBOM. This rule will fail also if the SBOM is not signed"
    level: warning
