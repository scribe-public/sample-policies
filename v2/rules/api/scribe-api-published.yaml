config-type: rule
id: scribe-published-policy
name: Scribe Published Policy
path: scribe-api-published.rego

description: Verify image Scribe Publish flag is set for container image.

labels:
  - Scribe

require-scribe-api: true

evidence: 
  signed: false
  content_body_type: cyclonedx-json
  # predicate_type: https://cyclonedx.org/bom

with:
  superset:
    published:

inputs:
  - name: superset
    type: object
    description: "The superset of CVEs to check for, including the following format {published: {flag: bool}}"

full-description: |
  This rule ensures that the product is published only after all critical or high severity vulnerabilities are addressed.

mitigation: Ensure that all critical or high severity vulnerabilities are addressed before delivering the product.

notes:
- Rule Uses Scribe API to check for CVEs in the target artifact, Ensure usage of Scribe Token in the environment.

input_example: |
  superset:
    published: true