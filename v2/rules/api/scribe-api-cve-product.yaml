config-type: rule
id: scribe-cve-product
name: Verify No Critical or High Vulnerabilities in Product
path: scribe-api.rego

description: Verify via Scribe API that there no critical or high severity vulnerabilities in any deliverable component of the product.

labels:
  - SCA
  - Blueprint
  - Scribe

require-scribe-api: true
skip-evidence: true

with:
  superset:
    cve:
      max: 0
      severity: 6

full-description: |
  This rule ensures that there are no critical or high severity vulnerabilities in any deliverable component of the product by verifying via the Scribe API.
mitigation: Ensure that all critical or high severity vulnerabilities are addressed before delivering the product.
inputs:
  - name: cve
    type: list
    description: List of CVEs to check against the product components.
