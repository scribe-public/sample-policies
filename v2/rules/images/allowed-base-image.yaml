config-type: rule
id: "allowed-base-image"
name: "Allowed Base Image"
path: "allowed-base-image.rego"

description: |
  Verifies that every base image is from an approved source. The rule returns a summary
  including the component names and versions of valid base images, or lists the invalid ones.
  This rule requires Dockerfile context; for example, run it with:
  `valint my_image --base-image Dockerfile`.

labels:
  - "SBOM"
  - "Images"

evidence:
  signed: false
  content_body_type: "cyclonedx-json"
  target_type: "container"
  filter-by:
  - target
  - product
with:
  approved_sources: []