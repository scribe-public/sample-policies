config-type: rule
id: "image-healthcheck"
name: "Container Healthcheck"
path: "image-healthcheck.rego"

description: |
  Ensures that the container image includes a Dockerfile HEALTHCHECK. 
  We look for at least one property starting with "imageHealthcheck_"
  in the CycloneDX SBOM metadata. If none is found, the rule fails.

labels:
  - "SBOM"
  - "Images"

level: "error"

evidence:
  signed: false
  content_body_type: "cyclonedx-json"
  target_type: "container"

# No special "with:" inputs needed for this rule
with: {}
