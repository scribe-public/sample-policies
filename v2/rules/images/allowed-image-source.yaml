config-type: rule
id: "allowed-image-source"
name: "Allowed Main Image Source"
path: "allowed-image-source.rego"
description: |
  Ensures the main container image referenced in the SBOM
  (metadata.component.name) is from an approved source.
help: "https://docs.example.com/container-policy#allowed-image-source"

labels:
  - "SBOM"
  - "Images"

level: "error"

evidence:
  # Adjust these as needed for your environment
  signed: false
  content_body_type: "cyclonedx-json"
  target_type: "container"

with:
  approved_sources: []
