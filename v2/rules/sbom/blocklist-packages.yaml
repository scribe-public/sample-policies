config-type: rule
id: sbom-disallow-dependencies
name: Restrict Disallowed Dependencies
path: blocklist-packages.rego

description: Verify the number of disallowed dependencies remains below the specified threshold.

inputs:
  - name: blocklist
    description: "A list of blocklisted components, including package name and min/max blocked versions."
    type: array
    required: true
  - name: blocklisted_limit
    description: "The maximum number of blocklisted components allowed."
    type: integer
    required: false
    default: 0

input_example: |-
  blocklist:
    - name: "example-blocked-package"
      min: "1.0.0"
      max: "1.0.1"

labels:
  - SBOM
  - Image
  - Blueprint

evidence:
  filter-by:
    - product
    - target
  signed: false
  content_body_type: cyclonedx-json
  target_type: container

with:
  blocklist: []
  blocklisted_limit: 0
