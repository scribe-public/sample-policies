config-type: rule
id: sarif-tool-evidence
name: Verify Tool Evidence in SARIF
path: verify-tool-evidence.rego

description: Verify required tools were used to generate the SARIF report.

full-description: |-  
  This rule checks the `tool` field in the SARIF evidence to verify that it matches the expected scanner 
  (e.g., "Semgrep Vulnerability Scanner" or "Trivy Vulnerability Scanner"). Set evidence match criteria: 
  the `tool` field must equal the expected scanner name to ensure the report is generated by the correct tool. 
  A mismatch indicates that the report may not be reliable.
  
  ### **Evidence Requirements**
  - Evidence must adhere to the SARIF 2.1.0 schema.
  - The report must include a valid `tool` field.

mitigation: >-
  Confirms the SARIF report originates from the correct scanning tool, ensuring the evidence is trustworthy.
  
labels:
  - SARIF

fail-on-missing-evidence: true

evidence:
  signed: false
  content_body_type: generic
  target_type: data
  tool: semgrep
  predicate_type: http://docs.oasis-open.org/sarif/sarif/2.1.0

