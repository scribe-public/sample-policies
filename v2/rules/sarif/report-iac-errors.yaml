config-type: rule
id: sarif-iac-findings
name: Verify IaC Misconfiguration Threshold in SARIF
path: report-iac-errors.rego

description: Verify the number of infrastructure-as-code (IaC) errors in the SARIF report remains below the specified threshold.
mitigation: >
  Ensures that IaC misconfiguration errors remain within acceptable limits, reducing the risk of deploying images 
  with insecure configuration settings.

full-description: |  
  This rule evaluates the SARIF report generated by the Vulnerability Scanner to detect vulnerabilities that match
  a specified blocklist of CVE identifiers. It processes the report by iterating over its vulnerability results, retrieving
  the corresponding rule definitions, and checking if the rule IDs contain any of the CVEs listed in the configuration.
  If the total number of matching vulnerabilities exceeds the allowed threshold, the rule records a violation that includes
  details such as the CVE identifier, its severity, and the location (artifact URI) where it was detected.
  
  ### **Evidence Requirements**
  
  Evidence must be provided in a SARIF 2.1.0 compliant format, generated by the Vulnerability Scanner.

labels:
  - SARIF

evidence:
  signed: false
  content_body_type: generic
  target_type: data
  predicate_type: http://docs.oasis-open.org/sarif/sarif/2.1.0

with:
  violations_threshold: 0

inputs:
  - name: violations_threshold
    type: integer
    description: The maximum number of allowed IaC misconfiguration errors.
    required: false
