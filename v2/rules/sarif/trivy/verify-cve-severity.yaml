config-type: rule
id: "trivy-verify-vulnerability-findings"
name: "Trivy Vulnerability Findings Check"
path: "../verify-trivy-cve-report.rego"

description: |
  Verifies that vulnerability findings in the SARIF evidence from Trivy do not exceed
  the defined severity threshold. The rule scans the SARIF report for any security-severity
  values above the threshold and fails if such violations are detected.

labels:
  - "SARIF"
  - "Trivy"

fail-on-missing-evidence: true

evidence:
  signed: false
  content_body_type: generic
  target_type: data
  predicate_type: "http://docs.oasis-open.org/sarif/sarif/2.1.0"
  tool: "Trivy Vulnerability Scanner"
  filter-by:
    - product


with:
  severity_threshold: 0
