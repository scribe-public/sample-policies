attest:
  cocosign:
    policies:
      - name: vikstore-verify
        enable: true
        modules:
          - name: git-coding-permissions
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                emails:
                  - victor.kartashov@gmail.com
              context-group:
                # - env
                - flags
              match:
                target_type: git
                content_type: "attest-cyclonedx-json"
                # sbomversion: "sha1:9418aa9e05292329e0ed76a84268c65b6d5d789d"
              #   predicate_type: '{{ .Context.predicate_type }}'
              #   input_name: "/tmp/testing_mock_repo/"
              rego:
                args:
                  ids:
                    - "@scribesecurity.com"
                  files:
                    - "Dockerfile"
                path: /home/viktor/scribe/sample-policies/policies/git/coding-permissions.rego
          - name: image-required-packages
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                emails:
                  - victor.kartashov@gmail.com
              context-group:
                # - env
                - flags
              match:
                target_type: image
                content_type: "attest-cyclonedx-json"
                # input_name: "localhost:5000/sigstore-local"
                # input_tag: "latest"
              rego:
                args:
                  required_pkgs:
                    - "pkg:deb/ubuntu/bash@5.1-6ubuntu1?arch=amd64\u0026distro=ubuntu-22.04"
                  violations_limit: 1
                path: /home/viktor/scribe/sample-policies/policies/sboms/required-packages.rego
          - name: image-banned-licenses
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                emails:
                  - victor.kartashov@gmail.com
              context-group:
                # - env
                - flags
              match:
                target_type: image
                content_type: "attest-cyclonedx-json"
                # input_name: "localhost:5000/sigstore-local"
                # input_tag: "latest"
              rego:
                args:
                  blocklist: 
                    - GPL
                    - MPL
                  blocklisted_limit : 1000
                path: /home/viktor/scribe/sample-policies/policies/sboms/banned-licenses.rego
          - name: trivy-check-vulnerabilities
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                emails:
                  - victor.kartashov@gmail.com
              context-group:
                # - env
                - flags
              match:
                target_type: generic
                predicate_type: http://scribesecurity.com/evidence/generic/v0.1
                content_type: "attest-generic"
              rego:
                args:
                  rule_level:
                    - critical
                  precision: []
                  rule_ids: []
                  ignore: []
                  max_allowed: 0
                path: /home/viktor/scribe/sample-policies/policies/sarif/verify-sarif.rego
