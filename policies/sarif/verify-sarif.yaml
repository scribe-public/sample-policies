attest:
  cocosign:
    policies:
    - name: sarif-policy
      enable: true
      modules:
      - name: sarif-policy
        type: verify-artifact
        enable: true
        input:
          signed: false
          format: '{{ .Context.content_type }}'
          match:
            target_type: '{{ .Context.target_type }}'
            predicate_type: '{{ .Context.predicate_type }}'
          rego:
            args:
              rule_level:
                - '{{ .Args.Error }}'
                - '{{ .Args.Warning }}'
                - '{{ .Args.Note }}'
                - '{{ .Args.None }}'
              precision: []
              rule_ids: #'{{block `list` .}}{{`[`}}{{printf `%v` .}}{{`]`}}{{end}}'
                - '{{ .Args.CVE_1 }}'
                - '{{ .Args.CVE_2 }}'
                - '{{ .Args.CVE_3 }}'
                - '{{ .Args.CVE_4 }}'
                # - '{{block `list` .}}{{range .}}{{.}}{{end}}{{end}}'
                # - '{{define `list`}} {{join . `, `}}{{end}}'
              ignore: []
              max_allowed: 1
            path: verify-sarif.rego
