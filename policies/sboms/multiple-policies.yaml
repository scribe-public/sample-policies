attest:
  cocosign:
    policies:
      - name: my_policy
        enable: true
        modules:
          - name: required-packages
            type: verify-artifact
            enable: true
            input:
              signed: false
              format: statement-cyclonedx-json
              match:
                target_type: image
              rego:
                args:
                  required_pkgs:
                    - "pkg:deb/ubuntu/bash@5.1-6ubuntu1?arch=amd64\u0026distro=ubuntu-22.04"
                  violations_limit: 1
                path: policies/sboms/required-packages.rego
          - name: fresh-sbom
            type: verify-artifact
            enable: true
            input:
              signed: false
              format: statement-cyclonedx-json
              match:
                target_type: image
              rego:
                args:
                  max_days : 30
                path: policies/sboms/fresh-sbom.rego
          - name: complete-licenses
            type: verify-artifact
            enable: true
            input:
              signed: false
              format: statement-cyclonedx-json
              match:
                target_type: image
              rego:
                path: policies/sboms/complete-licenses.rego
          - name: blocklist-packages
            type: verify-artifact
            enable: true
            input:
              signed: false
              format: statement-cyclonedx-json
              match:
                target_type: image
              rego:
                args:
                  blocklist: 
                    - "pkg:deb/ubuntu/tar@1.34+dfsg-1ubuntu0.1.22.04.1?arch=arm64&distro=ubuntu-22.04"
                    - "log4j"
                  blocklisted_limit: 0
                path: policies/sboms/blocklist-packages.rego
          - name: blocklist-licenses
            type: verify-artifact
            enable: true
            input:
              signed: false
              format: statement-cyclonedx-json
              match:
                target_type: image
              rego:
                args:
                  blocklist:
                    - "GPL"
                    - "MPL"
                  blocklisted_limit : 100
                path: policies/sboms/banned-licenses.rego
