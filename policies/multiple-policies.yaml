scribe:
  auth:
    login-url: https://scribe-hub-staging.us.auth0.com
    grant-type: client_credentials
    enable: true
    audience: api.staging.scribesecurity.com
  url: https://airflow.staging.scribesecurity.com
attest:
  cocosign:
    policies:
      - name: vikstore-verify
        enable: true
        modules:
          - name: git-coding-permissions
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                common-names:
                  - EvidencePolicyResults41
              context-group:
                # - env
                - none
              format: "attest-cyclonedx-json"
              match:
                target_type: git
                # content_type: "attest-cyclonedx-json"
                # sbomversion: "sha1:9418aa9e05292329e0ed76a84268c65b6d5d789d"
              #   predicate_type: '{{ .Context.predicate_type }}'
              #   input_name: "/tmp/testing_mock_repo/"
              rego:
                args:
                  ids:
                    - "viktor@scribesecurity.com"
                    # - "WhoIsThat@scribesecurity.com"
                  files:
                    - "Dockerfile"
                path: /home/viktor/scribe/sample-policies/policies/git/coding-permissions.rego
          - name: image-required-packages
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                common-names:
                  - EvidencePolicyResults4
              context-group:
                # - env
                - flags
              format: "attest-cyclonedx-json"
              match:
                target_type: image
                # input_name: "localhost:5000/sigstore-local"
                # input_tag: "latest"
              rego:
                args:
                  required_pkgs:
                    - "pkg:deb/ubuntu/bash@5.1-62ubuntu1?arch=amd64\u0026distro=ubuntu-22.04"
                  violations_limit: 0
                path: /home/viktor/scribe/sample-policies/policies/sboms/required-packages.rego
          - name: image-banned-licenses
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                common-names:
                  - EvidencePolicyResults4
              context-group:
                # - env
                - flags
              format: "attest-cyclonedx-json"
              match:
                target_type: image
                # input_name: "localhost:5000/sigstore-local"
                # input_tag: "latest"
              rego:
                args:
                  blocklist: 
                    - GPL
                  blocklisted_limit : 10
                path: /home/viktor/scribe/sample-policies/policies/sboms/banned-licenses.rego
          - name: trivy-check-vulnerabilities
            type: verify-artifact
            enable: true
            input:
              signed: true
              identity:
                common-names:
                  - EvidencePolicyResults41
              context-group:
                # - env
                - flags
              format: "attest-generic"
              match:
                target_type: generic
                predicate_type: http://scribesecurity.com/evidence/generic/v0.1
              rego:
                args:
                  rule_level:
                    - critical
                  precision: []
                  rule_ids: []
                  ignore: []
                  max_allowed: 1000
                path: /home/viktor/scribe/sample-policies/policies/sarif/verify-sarif.rego
