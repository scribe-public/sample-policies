# Initiative: NIST Application Container Security Initiative

**ID**: `SP-800-190`  
**Version**: `1.0.0`  
**Source YAML**: `sp-800-190.yaml`  

**Short Description**: This initiative enforces container security controls as outlined in  NIST SP 800-190. It ensures that containerized applications follow  security best practices, including vulnerability scanning, trusted  image sources, registry security, and proper configuration to minimize risk. The initiative enables policy-driven enforcement of security controls  throughout the software development lifecycle (SDLC), providing real-time  feedback to developers and enforcement in CI/CD pipelines.


**Help**: https://csrc.nist.gov/publications/detail/sp/800-190/final

## Defaults

```yaml
evidence:
  signed: false
```

## Controls Overview

| Control ID | Control Name | Control Description |
|------------|--------------|---------------------|
|  | 4.1 IMAGE COUNTERMEASURES | Implements security controls to reduce risks associated with  container images, such as vulnerabilities, misconfigurations,  and unauthorized images. The policies enforce CVE scanning,  mandatory security settings, and allow only trusted sources.
 |
|  | 4.2 REGISTRY COUNTERMEASURES | Implements controls to secure container image registries by enforcing  HTTPS connections, verifying image freshness, and preventing stale  images from being used.
 |

## Detailed Controls

### Control: 4.1 IMAGE COUNTERMEASURES (ID: ``)
**Description**: Implements security controls to reduce risks associated with  container images, such as vulnerabilities, misconfigurations,  and unauthorized images. The policies enforce CVE scanning,  mandatory security settings, and allow only trusted sources.


#### Rules

| Rule ID | Rule Name | Rule Description |
|---------|----------|------------------|
| trivy-verify-vulnerability-findings | [4.1.1 Severity-Based Vulnerabilities (Trivy)](../rules/sarif/trivy/verify-cve-severity.md) | Ensures that images do not contain high-severity vulnerabilities. Blocks images if any CVEs exceed the defined severity threshold.
 |
| trivy-blocklist-cve | [4.1.1 High-Profile Vulnerabilities (Trivy)](../rules/sarif/trivy/blocklist-cve.md) | Blocks images that contain specific high-profile CVEs that are  actively exploited or widely known.
 |
| sbom-disallowed-users | [4.1.2 Default Non-Root User](../rules/images/banned-users.md) | Ensures that containers do not run as the root user.
 |
| images-banned-ports | [4.1.2 Banned Open Port 22](../rules/images/banned-ports.md) | Blocks images that expose SSH (port 22), which should not be  used in containerized applications.
 |
| images-require-healthcheck | [4.1.3 Set HEALTHCHECK Instruction](../rules/images/require-healthcheck.md) | Ensures that container images include a HEALTHCHECK instruction  to monitor their runtime health.
 |
| image-labels | [4.1.3 Verify Required Image Labels](../rules/images/verify-labels.md) | Enforces the presence of essential OpenContainers labels, such as  creation time, version, and source repository.
 |
| images-allowed-base-image | [4.1.5 Approved Source Base Images](../rules/images/allowed-base-image.md) | Ensures that base images originate from approved and trusted sources.
 |
| images-allowed-image-source | [4.1.5 Approved Source Images](../rules/images/allowed-image-source.md) | Ensures that application images are built from approved sources.
 |
| images-require-signed-image | [4.1.5 Signed Images](../rules/images/image-signed.md) | Ensures that images are cryptographically signed before execution.
 |

### Control: 4.2 REGISTRY COUNTERMEASURES (ID: ``)
**Description**: Implements controls to secure container image registries by enforcing  HTTPS connections, verifying image freshness, and preventing stale  images from being used.


#### Rules

| Rule ID | Rule Name | Rule Description |
|---------|----------|------------------|
| images-registry-https-check | [4.2.1 Registry Connection Enforcement](../rules/images/enforce-https-registry.md) | Ensures that images are only pulled from registries using HTTPS.
 |
| images-fresh-base-image | [4.2.2 Up-to-Date Base Images](../rules/images/fresh-base-image.md) | Ensures that base images are not older than a specified time limit.
 |
| fresh-image | [4.2.2 Up-to-Date Derived Images](../rules/images/fresh-image.md) | Ensures that derived images are refreshed regularly and not outdated.
 |
